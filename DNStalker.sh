#!/bin/bash

export GREP_COLORS='ms=01;33'
blue='\033[1;34m'
NC='\033[0m'

echo " "
echo -e "${blue}Author: Warren Vos <info@redmoonsecurity.com>"
echo -e "GitHub: https://github.com/RedMoon-Security/DNStalker${NC}"
echo " "

 echo ' '
 echo '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'
 echo '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'
 echo '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'
 echo '@@@@@@@                                                                                                         @@@@@@@'
 echo '@@@@@@@   @@@@@@@@@@@@@@@@@@@@@@             @@@@@@@@@@@@@@@@@@@@@@@@@@@     @@@@@@@@@@@@@@@@@@@@               @@@@@@@'
 echo '@@@@@@@   @@@@@@@@@@@@@@@@@@@@@@@@@@@        @@@@@@@@@@@@@@@@@@@@@@@@@@@     @@@@@@@@@@@@@@@@@@@@@@@@@          @@@@@@@'
 echo '@@@@@@@   @@@@@@@@@@@@@@@@@@@@@@@@@@@@       @@@@@@@@@@@@@@@@@@@@@@@@@@@     @@@@@@@@@@@@@@@@@@@@@@@@@@@@       @@@@@@@'
 echo '@@@@@@@   @@@@@@@@@         @@@@@@@@@@@      @@@@@@@@@                       @@@@@@@@@       @@@@@@@@@@@@@@     @@@@@@@'
 echo '@@@@@@@   @@@@@@@@@           @@@@@@@@@@     @@@@@@@@@                       @@@@@@@@@           @@@@@@@@@@@    @@@@@@@'
 echo '@@@@@@@   @@@@@@@@@           @@@@@@@@@      @@@@@@@@@@@@@@@@@@@@@@@@@       @@@@@@@@@             @@@@@@@@@    @@@@@@@'
 echo '@@@@@@@   @@@@@@@@@       @@@@@@@@@@@@@      @@@@@@@@@@@@@@@@@@@@@@@@@       @@@@@@@@@             @@@@@@@@@@   @@@@@@@'
 echo '@@@@@@@   @@@@@@@@@@@@@@@@@@@@@@@@@@@        @@@@@@@@@@@@@@@@@@@@@@@@@       @@@@@@@@@             @@@@@@@@@,   @@@@@@@'
 echo '@@@@@@@   @@@@@@@@@@@@@@@@@@@@@@@@           @@@@@@@@@                       @@@@@@@@@            @@@@@@@@@@    @@@@@@@'
 echo '@@@@@@@   @@@@@@@@@    @@@@@@@@@@@           @@@@@@@@@                       @@@@@@@@@          @@@@@@@@@@@     @@@@@@@'
 echo '@@@@@@@   @@@@@@@@@      @@@@@@@@@@@         @@@@@@@@@@@@@@@@@@@@@@@@@@@     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@      @@@@@@@'
 echo '@@@@@@@   @@@@@@@@@        @@@@@@@@@@        @@@@@@@@@@@@@@@@@@@@@@@@@@@     @@@@@@@@@@@@@@@@@@@@@@@@@@@        @@@@@@@'
 echo '@@@@@@@   @@@@@@@@@         @@@@@@@@@@@      @@@@@@@@@@@@@@@@@@@@@@@@@@@     @@@@@@@@@@@@@@@@@@@@@@@            @@@@@@@'
 echo '@@@@@@@                                                                                                         @@@@@@@'
 echo '@@@@@@@                                                                                                         @@@@@@@'
 echo '@@@@@@@                                                                                                         @@@@@@@'
 echo '@@@@@@@   @@@@@@@           @@@@@@@            @@@@@@@@@@                  @@@@@@@@@@           @@@@@@@         @@@@@@@'
 echo '@@@@@@@   @@@@@@@@@        @@@@@@@@        @@@@@@@@@@@@@@@@@@          @@@@@@@@@@@@@@@@@@       @@@@@@@@@       @@@@@@@'
 echo '@@@@@@@   @@@@@@@@@@     @@@@@@@@@@      @@@@@@@@@@@@@@@@@@@@@@      @@@@@@@@@@@@@@@@@@@@@@     @@@@@@@@@@@     @@@@@@@'
 echo '@@@@@@@   @@@@@@@@@@@@ @@@@@@@@@@@@    @@@@@@@@          @@@@@@@    @@@@@@@          @@@@@@@    @@@@@@@@@@@@@   @@@@@@@'
 echo '@@@@@@@   @@@@@@&@@@@@@@@@@@@@@@@@@    @@@@@@@            @@@@@@@  @@@@@@@            @@@@@@@   @@@@@@@@@@@@@@@ @@@@@@@'
 echo '@@@@@@@   @@@@@@& @@@@@@@@@  @@@@@@    @@@@@@@            @@@@@@@  @@@@@@@            @@@@@@@   @@@@@@@  @@@@@@@@@@@@@@'
 echo '@@@@@@@   @@@@@@&   @@@@@    @@@@@@    @@@@@@@@          @@@@@@@    @@@@@@@          @@@@@@@@   @@@@@@@    @@@@@@@@@@@@'
 echo '@@@@@@@   @@@@@@&     @@     @@@@@@     @@@@@@@@@@    @@@@@@@@@      @@@@@@@@@    @@@@@@@@@     @@@@@@@      @@@@@@@@@@'
 echo '@@@@@@@   @@@@@@&            @@@@@@       @@@@@@@@@@@@@@@@@@@          @@@@@@@@@@@@@@@@@@@      @@@@@@@        @@@@@@@@'
 echo '@@@@@@@   @@@@@@&            @@@@@@           @@@@@@@@@@@@                @@@@@@@@@@@@          @@@@@@@          @@@@@@'
 echo '                                                                                                                       '
 echo '                                                                                                                       '
 echo ' @@@@@@@        @@@@@@@@         @@@@@@@@        @@@   @@@        @@@@@@@@@        @@@       @@@@@@@@@        @@@  @@@ '
 echo '@@@@@@          @@@@@@@@        @@@              @@@   @@@        @@@    @@@       @@@          @@@            @@@@@@  '
 echo '     @@@@       @@@             @@@              @@@   @@@        @@@@@@@          @@@          @@@              @@    '
 echo '@@@@@@@@        @@@@@@@@@        @@@@@@@@         @@@@@@@         @@@   @@@        @@@          @@@              @@    '

echo " "
echo "----------------------------------------------------"
echo -e "${blue}Finding SOA Record for $1${NC}"
echo "----------------------------------------------------"
if [ "$1" == "" ]
then
echo "Please provide a domain"
echo "Example: ./DNStalker.sh mydomain.com"
else
for domain in $1
do
host -t SOA $1 | cut -d " " -f1-6 | sed 's/.com. /.com /' | sed -r 's/\.$//g' 
done
fi

echo " "
echo "----------------------------------------------------"
echo -e "${blue}Finding TXT Records for $1${NC}"
echo "----------------------------------------------------"
if [ "$1" == "" ]
then
echo "Please provide a domain"
echo "Example: ./DNStalker.sh mydomain.com"
else
for domain in $1
do
host -t txt $1 
done
fi

echo " "
echo "----------------------------------------------------"
echo -e "${blue}Finding MX Records for $1${NC}"
echo "----------------------------------------------------"
if [ "$1" == "" ]
then
echo "Please provide a domain"
echo "Example: ./DNStalker.sh mydomain.com"
else
for domain in $1
do
host -n -t mx $1 | cut -d " " -f7 | sed -r 's/\.$//g' 
done
fi

echo " "
echo "----------------------------------------------------"
echo -e "${blue}Finding Name Servers for $1${NC}"
echo "----------------------------------------------------"
if [ "$1" == "" ]
then
echo "Please provide a domain"
echo "Example: ./DNStalker.sh mydomain.com"
else
for domain in $1
do
host -t ns $1 | cut -d " " -f4 | sed -r 's/\.$//g' 
done
fi

echo " "
echo "----------------------------------------------------"
echo -e "${blue}Finding and Resolving Subdomains for $1${NC}"
echo "----------------------------------------------------"
if [ "$1" == "" ]
then
echo "Please provide a domain"
echo "Example: ./DNStalker.sh mydomain.com"
else
for domain in $(cat subdomain_list.txt)
do
host $domain.$1 | grep --color=auto "has address" 
done
fi

echo " "
echo "----------------------------------------------------"
echo -e "${blue}Attempting Zone Transfer for $1 Name Servers${NC}"
echo "----------------------------------------------------"
if [ "$1" == "" ]
then
echo "Please provide a domain"
echo "Example: ./DNStalker.sh mydomain.com"
else
for server in $(host -t ns $1 | cut -d " " -f4)
do
host -l $1 $server 
done
fi



